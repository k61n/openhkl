# Streptavidin autoindexing tests - instructions

## General comments

The parameters as found in the GUI are input via the `Parameters` class in `experiment.py`. In the scripts I use the GUI defaults, but if you want to modify them, be sure to pass the relevant key/value pairs the the constructor.

I have hard-coded the reference cell parameters for my working example (streptavidin+biotin) into the `test_data_set.py` script for now, be sure to modify if you're using a different data set.

## `scripts/autoindex/autoindex.py`

1. Modify $PYTHONPATH in `autoindex.py` to point to the swig directory in the NSXTool build directory:
   `sys.path.append("/home/zamaan/codes/nsxtool/nsxtool/build/swig")`
2. Run the script on the a set of .tiff raw data files
   ```path/to/autoindextest.py --name strep --files *.tiff```
   This will run the autoindexer on a dataset generated by all `.tiff` files provided as the argument. Note that the intermediate information will be saved as `strep.nsx` (or whatever is provided by the `--name` flag) after the integration step, and if this file is found for later calculations, it will automatically be loaded.
3. The script will dump a list of solutions from the autoindexer to stdout:
	```
   Quality         a         b         c     alpha      beta     gamma
   100.000  46.11586  93.09011 104.46404  90.00000  90.00000  90.00000
   100.000  45.66522  92.98052 210.51565  89.58908  89.61555  88.50348
   100.000  73.58283  73.85300 212.09144  85.99679  83.88316  78.19238
   100.000 328.53789  45.64939  92.96886  90.00000 106.03065  90.00000
   100.000  73.84290 130.27473 167.87320  89.23272  85.71576  76.68054
   100.000  73.82463 210.25625 212.40960  64.04887  86.03049  87.29217
   100.000  93.05285 172.02372 229.34880  97.24204 100.13018  90.85082
   100.000 172.87479  93.01095 253.38225  90.00000  93.86085  90.00000
    90.000 524.03768  93.06929 252.10529  90.00000  91.72697  90.00000
    40.000   8.94176  38.23128  73.37329  81.44158  88.95458  85.79302
	```

## `scripts/autoindex/test_data_set.py`

1. Modify $PYTHONPATH in `test_data_set.py` to point to the swig directory in the NSXTool build directory:
   ```sys.path.append("/home/zamaan/codes/nsxtool/nsxtool/build/swig")```
2. Run the script on the a set of .tiff raw data files
   ```path/to/test_data_set.py --name strep --files *.tiff -n 8```
   This will do all processing steps for all sets of 8 *contiguous* frames up to and including the autoindexing step. Be sure to modify the reference cell parameters.
3. The script will generate a log file that looks like this:
	```
	Set 2       [2, 3, 4, 5, 6, 7, 8, 9]   93.75    46.600    93.407   104.293   90.000   90.000   90.000
	Caught 288/638 peaks
	p15843_00027668.tiff p15843_00027669.tiff p15843_00027670.tiff p15843_00027671.tiff p15843_00027672.tiff p15843_00027673.tiff p15843_00027674.tiff p15843_00027675.tiff
	Set 4       [4, 5, 6, 7, 8, 9, 10, 11]   96.08    46.816    93.162   103.499   90.000   90.000   90.000
	Caught 268/651 peaks
	p15843_00027670.tiff p15843_00027671.tiff p15843_00027672.tiff p15843_00027673.tiff p15843_00027674.tiff p15843_00027675.tiff p15843_00027676.tiff p15843_00027677.tiff
	Set 10      [10, 11, 12, 13, 14, 15, 16, 17]   83.33    46.680    93.603   104.098   90.000   90.000   90.000
	Caught 251/614 peaks
	p15843_00027676.tiff p15843_00027677.tiff p15843_00027678.tiff p15843_00027679.tiff p15843_00027680.tiff p15843_00027681.tiff p15843_00027682.tiff p15843_00027683.tiff
	```
	The first line is the integer label for the dataset, followed by the set of integer labels for the respective frames (`.tiff` files), followed by the cell parameters a, b, c, alpha, beta, gamma. The seconnd line is the number of peaks caught by the filter as a fraction of the total number of peaks found and integrated. The third line is the names of the files used for the autoindexing.
